<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSONP Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .result { margin: 20px 0; padding: 10px; border: 1px solid #ccc; background: #f9f9f9; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <h1>JSONP Test for Medium RSS Feed</h1>
    <button onclick="testJsonp()">Test JSONP</button>
    <div id="result" class="result">Click the button to test JSONP...</div>

    <script>
        function myCallback(data) {
            console.log('Callback received:', data);
            const resultDiv = document.getElementById('result');
            if (data && data.status === 'ok' && data.items && data.items.length > 0) {
                resultDiv.innerHTML = '<div class="success">SUCCESS: Received ' + data.items.length + ' posts</div>';
                resultDiv.innerHTML += '<h3>Sample Post:</h3>';
                resultDiv.innerHTML += '<strong>' + data.items[0].title + '</strong><br>';
                resultDiv.innerHTML += 'Published: ' + new Date(data.items[0].pubDate).toLocaleDateString() + '<br>';
                resultDiv.innerHTML += '<a href="' + data.items[0].link + '" target="_blank">Read Post</a>';
            } else {
                resultDiv.innerHTML = '<div class="error">ERROR: Invalid data received</div>';
                resultDiv.innerHTML += '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            }
        }

        function testJsonp() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = 'Loading...';

            const script = document.createElement('script');
            const timestamp = Date.now();
            script.src = 'https://api.rss2json.com/v1/api.json?rss_url=https://medium.com/feed/@gmrafi&callback=myCallback&_=' + timestamp;
            script.onerror = function() {
                resultDiv.innerHTML = '<div class="error">ERROR: Script failed to load</div>';
            };
            document.head.appendChild(script);
        }
    </script>
</body>
</html>